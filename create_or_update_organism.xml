<?xml version="1.0"?>
<tool id="edu.tamu.cpt2.webapollo.create_or_update" name="WA2: Create or Update Organism" version="1.5">
  <description>will create the organism if it doesn't exist, and update otherwise</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <command detect_errors="aggressive"><![CDATA[
cp -R ${jbrowse.extra_files_path}/data/ /opt/apollo/data/galaxy/${jbrowse.id};

python $__tool_directory__/create_or_update_organism.py

@AUTH@

#if str($blatdb) != "None":
    --blatdb "$blatdb"
#end if

--genus "$genus"
--species "$species"
$public

@CN_OR_GUESS@

"/opt/apollo/data/galaxy/${jbrowse.id}"

$__user_email__

> $output]]></command>
  <inputs>
    <param name="jbrowse" type="data" format="html" label="JBrowse HTML Output" />
    <param name="blatdb" type="data" label="Blat DB" optional="True" />

    <expand macro="cn_or_guess" />
    <param name="genus" type="text" label="Host Bacteria" optional="True" />
    <param name="species" type="text" label="Phage Name" optional="True" />
    <param name="public" type="boolean" truevalue="--public" falsevalue="" label="Is Organism Public" />
  </inputs>
  <outputs>
    <data format="json" name="output"/>
  </outputs>
  <help><![CDATA[
**NOTA BENE**

All organism data is currently shared. By using this tool your annotation data will be visible to your fellow lab members.
This will be fixed at a later date.

This only works with JBrowse v0.4 and above!

**What it does**

Adds an organism to the Apollo database. The tool takes the output of a
JBrowse run as that contains all of the necessary information for which
tracks are appropriate for a given analysis.

@REFERENCES@
      ]]></help>
</tool>
